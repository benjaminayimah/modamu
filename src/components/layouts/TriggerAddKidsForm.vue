<template>
    <div class="flx jc-c">
        <svg v-if="newUser.completed" xmlns="http://www.w3.org/2000/svg" height="150" viewBox="0 0 100 100">
            <path d="M53.375,3.375a50,50,0,1,0,50,50A49.992,49.992,0,0,0,53.375,3.375Zm25.6,36.178L46.837,71.837h-.024a4.341,4.341,0,0,1-2.788,1.322,4.208,4.208,0,0,1-2.812-1.37L27.75,58.327a.958.958,0,0,1,0-1.37l4.279-4.279a.929.929,0,0,1,1.346,0L44.048,63.351,73.375,33.808a.949.949,0,0,1,.673-.288h0a.873.873,0,0,1,.673.288l4.207,4.351A.948.948,0,0,1,78.976,39.553Z" transform="translate(-3.375 -3.375)" fill="#2ECE8B"/>
        </svg>
        <svg id="kids" v-else-if="newUser.kids.length == 0" xmlns="http://www.w3.org/2000/svg" height="150" viewBox="0 0 194.5 143">
            <g transform="translate(-1444 -339)">
                <g>
                    <path d="M-1958,145a31.8,31.8,0,0,1-12.455-2.515,31.9,31.9,0,0,1-10.172-6.858,31.893,31.893,0,0,1-6.858-10.171A31.8,31.8,0,0,1-1990,113a31.816,31.816,0,0,1,2.426-12.244,31.9,31.9,0,0,1,6.629-10.061,31.925,31.925,0,0,1,9.858-6.905,31.756,31.756,0,0,1,12.113-2.775,69.645,69.645,0,0,0,3.874,13.768,69.926,69.926,0,0,0,6.46,12.461,70.466,70.466,0,0,0,8.733,10.841,70.5,70.5,0,0,0,10.692,8.908,32.088,32.088,0,0,1-11.595,13A31.9,31.9,0,0,1-1958,145Z" transform="translate(3434 337)" fill="#ffba02"/>
                    <path d="M-480.578-342.625c-1.847,0-3.2-.049-4.242-.155a8.312,8.312,0,0,1-2.569-.577,2.432,2.432,0,0,1-1.27-1.169,4.363,4.363,0,0,1-.341-1.927,4.357,4.357,0,0,1,.342-1.928,2.432,2.432,0,0,1,1.269-1.168,8.313,8.313,0,0,1,2.569-.577c1.047-.106,2.4-.155,4.242-.155s3.194.049,4.241.155a8.319,8.319,0,0,1,2.571.577,2.435,2.435,0,0,1,1.27,1.169,4.36,4.36,0,0,1,.34,1.927,4.366,4.366,0,0,1-.34,1.928,2.434,2.434,0,0,1-1.269,1.168,8.316,8.316,0,0,1-2.571.577C-477.384-342.674-478.731-342.625-480.578-342.625Zm0-6.125c-1.795,0-3.094.047-4.089.147a7.149,7.149,0,0,0-2.09.448.93.93,0,0,0-.527.445,3.082,3.082,0,0,0-.186,1.256,3.091,3.091,0,0,0,.186,1.256.93.93,0,0,0,.527.446,7.149,7.149,0,0,0,2.09.448c.995.1,2.294.147,4.088.147s3.093-.047,4.087-.147a7.154,7.154,0,0,0,2.091-.448.931.931,0,0,0,.527-.445,3.094,3.094,0,0,0,.185-1.256,3.09,3.09,0,0,0-.185-1.255.931.931,0,0,0-.528-.447,7.157,7.157,0,0,0-2.091-.448C-477.485-348.7-478.784-348.75-480.578-348.75Zm0-3.063a4.6,4.6,0,0,1-4.594-4.594A4.6,4.6,0,0,1-480.578-361a4.6,4.6,0,0,1,4.594,4.593A4.6,4.6,0,0,1-480.578-351.813Zm0-7.656a3.066,3.066,0,0,0-3.063,3.062,3.066,3.066,0,0,0,3.063,3.063,3.066,3.066,0,0,0,3.063-3.063A3.066,3.066,0,0,0-480.578-359.468Z" transform="translate(1956.642 801.318)" fill="#fff"/>
                </g>
                <g>
                    <path d="M-1923,134a66.579,66.579,0,0,1-26.079-5.265,67.008,67.008,0,0,1-11.381-6.177,67.5,67.5,0,0,1-9.916-8.181,67.49,67.49,0,0,1-8.181-9.916,67.011,67.011,0,0,1-6.177-11.381A66.581,66.581,0,0,1-1990,67a66.579,66.579,0,0,1,5.265-26.079,67.01,67.01,0,0,1,6.177-11.381,67.5,67.5,0,0,1,8.181-9.916,67.49,67.49,0,0,1,9.916-8.181,67.01,67.01,0,0,1,11.381-6.177A66.579,66.579,0,0,1-1923,0a66.582,66.582,0,0,1,26.08,5.265,67.005,67.005,0,0,1,11.381,6.177,67.487,67.487,0,0,1,9.916,8.181,67.489,67.489,0,0,1,8.181,9.916,67.019,67.019,0,0,1,6.177,11.381A66.581,66.581,0,0,1-1856,67c0,1.35-.041,2.714-.121,4.055-.616-.036-1.248-.054-1.879-.054a31.8,31.8,0,0,0-12.456,2.515,31.9,31.9,0,0,0-10.172,6.858,31.891,31.891,0,0,0-6.858,10.171A31.8,31.8,0,0,0-1890,103a31.785,31.785,0,0,0,5.918,18.545,66.7,66.7,0,0,1-18.131,9.169A66.949,66.949,0,0,1-1923,134Z" transform="translate(3467 339)" fill="#4115B9"/>
                    <path d="M-468.609-316.513c-4.472,0-7.736-.119-10.271-.375a20.123,20.123,0,0,1-6.221-1.4,5.889,5.889,0,0,1-3.074-2.83,10.563,10.563,0,0,1-.825-4.666,10.548,10.548,0,0,1,.827-4.669,5.888,5.888,0,0,1,3.073-2.827,20.125,20.125,0,0,1,6.22-1.4c2.535-.256,5.8-.375,10.271-.375s7.734.119,10.268.375a20.14,20.14,0,0,1,6.223,1.4,5.9,5.9,0,0,1,3.075,2.83,10.556,10.556,0,0,1,.823,4.665,10.571,10.571,0,0,1-.824,4.667,5.894,5.894,0,0,1-3.073,2.828,20.135,20.135,0,0,1-6.224,1.4C-460.876-316.632-464.138-316.513-468.609-316.513Zm0-14.829c-4.346,0-7.491.113-9.9.356a17.308,17.308,0,0,0-5.06,1.085,2.25,2.25,0,0,0-1.275,1.079,7.462,7.462,0,0,0-.451,3.042,7.482,7.482,0,0,0,.45,3.04,2.251,2.251,0,0,0,1.275,1.08,17.306,17.306,0,0,0,5.061,1.085c2.408.243,5.553.356,9.9.356s7.488-.113,9.9-.356a17.321,17.321,0,0,0,5.062-1.085,2.254,2.254,0,0,0,1.275-1.079,7.493,7.493,0,0,0,.448-3.042,7.481,7.481,0,0,0-.447-3.038,2.255,2.255,0,0,0-1.277-1.082,17.328,17.328,0,0,0-5.062-1.084C-461.12-331.229-464.265-331.342-468.609-331.342Zm0-7.415a11.135,11.135,0,0,1-11.123-11.122A11.134,11.134,0,0,1-468.609-361a11.134,11.134,0,0,1,11.123,11.12A11.135,11.135,0,0,1-468.609-338.757Zm0-18.535a7.423,7.423,0,0,0-7.415,7.413,7.424,7.424,0,0,0,7.415,7.415,7.424,7.424,0,0,0,7.415-7.415A7.422,7.422,0,0,0-468.609-357.292Z" transform="translate(2012.879 744.371)" fill="#fff"/>
                </g>
                <g transform="translate(0.5 0.5)">
                    <circle cx="29.5" cy="29.5" r="29.5" transform="translate(1579 412)" fill="#e01818"/>
                    <path d="M-480.578-342.625c-1.847,0-3.2-.049-4.242-.155a8.312,8.312,0,0,1-2.569-.577,2.432,2.432,0,0,1-1.27-1.169,4.363,4.363,0,0,1-.341-1.927,4.357,4.357,0,0,1,.342-1.928,2.432,2.432,0,0,1,1.269-1.168,8.313,8.313,0,0,1,2.569-.577c1.047-.106,2.4-.155,4.242-.155s3.194.049,4.241.155a8.319,8.319,0,0,1,2.571.577,2.435,2.435,0,0,1,1.27,1.169,4.36,4.36,0,0,1,.34,1.927,4.366,4.366,0,0,1-.34,1.928,2.434,2.434,0,0,1-1.269,1.168,8.316,8.316,0,0,1-2.571.577C-477.384-342.674-478.731-342.625-480.578-342.625Zm0-6.125c-1.795,0-3.094.047-4.089.147a7.149,7.149,0,0,0-2.09.448.93.93,0,0,0-.527.445,3.082,3.082,0,0,0-.186,1.256,3.091,3.091,0,0,0,.186,1.256.93.93,0,0,0,.527.446,7.149,7.149,0,0,0,2.09.448c.995.1,2.294.147,4.088.147s3.093-.047,4.087-.147a7.154,7.154,0,0,0,2.091-.448.931.931,0,0,0,.527-.445,3.094,3.094,0,0,0,.185-1.256,3.09,3.09,0,0,0-.185-1.255.931.931,0,0,0-.528-.447,7.157,7.157,0,0,0-2.091-.448C-477.485-348.7-478.784-348.75-480.578-348.75Zm0-3.063a4.6,4.6,0,0,1-4.594-4.594A4.6,4.6,0,0,1-480.578-361a4.6,4.6,0,0,1,4.594,4.593A4.6,4.6,0,0,1-480.578-351.813Zm0-7.656a3.066,3.066,0,0,0-3.063,3.062,3.066,3.066,0,0,0,3.063,3.063,3.066,3.066,0,0,0,3.063-3.063A3.066,3.066,0,0,0-480.578-359.468Z" transform="translate(2089.14 793.318)" fill="#fff"/>
                </g>
            </g>
        </svg>
        <div class="flx w-100 gap-4 jc-c kids-wrapper" v-else>
            <div v-for="kid in newUser.kids" :key="kid.id" class="bg-img br-50" :style="kid.photo ? { backgroundImage: 'url('+getHostname+'/storage/'+newUser.id+'/'+kid.photo+')'} : { backgroundImage: 'url('+getDefaultImage+')'}" :title="kid.name"></div>
        </div>
    </div>
    <div v-if="!newUser.completed" class="flx ai-c column gap-16">
        <h1>Add kids</h1>
        <div class="text-center gray">Add as many kids as you wish. You also have the ability to edit their personal information at anytime.</div>
        <button class="button-outline rounded-outl" @click="$store.commit('openModal', 'kids')">{{ newUser.kids.length > 0 ? 'Add more' : 'Add your kids' }}</button>
    </div>
    <div v-else class="flx ai-c column gap-16">
        <h1>Completed!!!</h1>
        <div class="text-center gray">Your sign up is completed successfully. You can now proceed to your dashbard.</div>
    </div>

    <button v-if="newUser.kids.length == 0 && !newUser.completed" class="button-primary w-100"  @click="loginUser">Skip</button>
    <button v-else-if="!newUser.completed" class="button-primary w-100" @click="loginUser">Finish</button>
    <button v-else class="button-primary w-100" @click="goToDashboard">Go to Dashboard</button>
</template>
<script>
import { mapGetters } from 'vuex';
export default {
    name: 'AddKids',
    props: ['newUser'],
    computed: mapGetters(['getHostname', 'getDefaultImage']),
    data() {
        return {
            token: JSON.parse(localStorage.getItem('newUser')).status.remember_token || null
        }
    },
    methods: {
        loginUser() {
            if(this.token) {
                this.$store.commit('newUserCompleted', this.token)
                this.$store.commit('setAuthToken', this.token)
            }
        },
        async goToDashboard() {
            await this.$store.commit('signInSuccess', this.token)
            this.$router.push({ name: 'AdminDashboard'})
        }
    }
}
</script>
<style lang="scss" scoped>
#kids{
    width: 100%;
}
.text-center{
    line-height: 1.5;
}
.bg-img{
    height: 80px;
    width: 80px;
}
.kids-wrapper{
    flex-wrap: wrap;
}
</style>